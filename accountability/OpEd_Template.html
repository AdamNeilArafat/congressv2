<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Evergreen Accountability — Op-Ed Template</title>
  <meta name="description" content="Op-ed and letter-to-editor generator for Evergreen Pact accountability actions. Includes print, PDF, and Word export." />
  <meta name="theme-color" content="#0d3b66" />

  <!-- Bootstrap + Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet"/>

  <style>
    :root{ --primary:#0d3b66; --accent:#0b6e4f; --danger:#c1121f; --ink:#1b2634; --soft:#f6f9fc; }
    body{ font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; color:var(--ink); }
    header.hero{ background:var(--soft); border-bottom:1px solid #e6edf3; }
    .editor{ max-width:850px; margin:auto; }
    .preview{ border:1px solid #e6edf3; border-radius:.75rem; padding:1.5rem; background:#fff; }
    .preview h1{ font-size:1.6rem; color:var(--primary); margin-bottom:1rem; }
    .preview .byline{ font-size:.9rem; color:#5b6b7a; margin-bottom:1rem; }
    .preview p{ margin-bottom:.9rem; line-height:1.5; }
  </style>
</head>
<body>
  <header class="hero">
    <nav class="container d-flex align-items-center justify-content-between py-3">
      <div class="d-flex align-items-center gap-2">
        <i class="fa-solid fa-tree text-success"></i>
        <strong>Evergreen Pact — Accountability</strong>
        <span class="badge text-bg-primary ms-2">Op-Ed Template</span>
      </div>
      <div class="d-flex gap-2">
        <button class="btn btn-outline-secondary" onclick="window.print()">
          <i class="fa-solid fa-print me-1"></i> Print / PDF
        </button>
        <button id="exportDocx" class="btn btn-primary">
          <i class="fa-solid fa-file-word me-1"></i> Export to Word (.docx)
        </button>
      </div>
    </nav>
  </header>

  <main class="container my-4 editor">
    <div class="mb-4">
      <label class="form-label fw-semibold">Target Representative</label>
      <input id="targetName" class="form-control mb-2" placeholder="Rep. Lastname" />
      <label class="form-label fw-semibold">Bill Name</label>
      <input id="billName" class="form-control mb-2" placeholder="Fair Food & Grocery Competition Bill" />
      <label class="form-label fw-semibold">Nickname (Branding)</label>
      <input id="nickname" class="form-control mb-2" placeholder="Grocery Gouger" />
      <label class="form-label fw-semibold">Op-Ed Title</label>
      <input id="opTitle" class="form-control mb-2" placeholder="Why Our Families Deserve Better than Rep. Lastname’s NO Vote" />
      <label class="form-label fw-semibold">Body Text (paragraphs)</label>
      <textarea id="opBody" class="form-control" rows="10" placeholder="Write or paste draft text here..."></textarea>
    </div>

    <div class="preview mb-4" id="preview">
      <h1 id="prevTitle">[Op-Ed Title]</h1>
      <div class="byline">By Adam Neil Arafat — For immediate release</div>
      <p><strong>Rep. [Lastname]</strong> — branded the <strong>[Nickname]</strong> — voted against the <em>[Bill Name]</em>, siding with corporate PACs over families.</p>
      <div id="prevBody">
        <p>This space will show the op-ed body text as you type.</p>
      </div>
      <p><em>Adam Neil Arafat is a candidate for Congress in Washington’s 10th District.</em></p>
    </div>
  </main>

  <!-- html-docx-js for Word export -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html-docx-js/0.4.1/html-docx.js"></script>
  <script>
    const targetName=document.getElementById('targetName');
    const billName=document.getElementById('billName');
    const nickname=document.getElementById('nickname');
    const opTitle=document.getElementById('opTitle');
    const opBody=document.getElementById('opBody');
    const prevTitle=document.getElementById('prevTitle');
    const prevBody=document.getElementById('prevBody');

    function updatePreview(){
      prevTitle.textContent = opTitle.value || '[Op-Ed Title]';
      document.querySelector('#preview p strong').textContent = targetName.value || '[Lastname]';
      document.querySelector('#preview p em').textContent = billName.value || '[Bill Name]';
      document.querySelector('#preview p strong:nth-of-type(2)').textContent = nickname.value || '[Nickname]';
      // Body paragraphs
      prevBody.innerHTML = '';
      opBody.value.split('\n').filter(Boolean).forEach(para=>{
        const p=document.createElement('p'); p.textContent=para; prevBody.appendChild(p);
      });
    }
    [targetName,billName,nickname,opTitle,opBody].forEach(el=>el.addEventListener('input',updatePreview));
    updatePreview();

    // Export to Word
    document.getElementById('exportDocx').addEventListener('click', ()=>{
      const html = `
      <!DOCTYPE html><html><head><meta charset="utf-8">
      <style>
        body{font-family:Calibri,Arial,sans-serif; color:#1b2634;}
        h1{color:#0d3b66; font-size:18pt; margin-bottom:6pt;}
        .byline{font-size:10pt; color:#5b6b7a; margin-bottom:12pt;}
        p{font-size:11pt; line-height:1.45; margin-bottom:10pt;}
        em{color:#0d3b66;}
      </style>
      </head><body>${document.getElementById('preview').outerHTML}</body></html>`;
      const blob=window.htmlDocx.asBlob(html,{margins:{top:720,right:720,bottom:720,left:720}});
      const url=URL.createObjectURL(blob);
      const a=document.createElement('a'); a.href=url; a.download='Evergreen_OpEd.docx';
      document.body.appendChild(a); a.click(); a.remove();
      setTimeout(()=>URL.revokeObjectURL(url),500);
    });
  </script>
</body>
</html>
