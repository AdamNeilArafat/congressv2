<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Evergreen Accountability — District Flyer</title>
  <meta name="description" content="Generate printable flyers/handouts for Evergreen Pact accountability actions. Includes print, PDF, and Word export." />
  <meta name="theme-color" content="#0d3b66" />

  <!-- Bootstrap + Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet"/>

  <style>
    :root{ --primary:#0d3b66; --accent:#0b6e4f; --danger:#c1121f; --ink:#1b2634; --soft:#f6f9fc; }
    body{ font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; color:var(--ink); }
    header.hero{ background:var(--soft); border-bottom:1px solid #e6edf3; }
    .flyer{ max-width:800px; margin:auto; border:2px solid var(--primary); border-radius:1rem; padding:2rem; background:#fff; }
    .flyer h1{ color:var(--primary); font-size:1.75rem; margin-bottom:.5rem; }
    .nickname{ font-size:2rem; font-weight:700; color:var(--danger); }
    .tagline{ font-size:1.1rem; font-weight:500; margin-bottom:1rem; color:var(--ink); }
    .impact ul{ list-style:disc; margin-left:1.5rem; }
    .voters ul{ columns:2; -webkit-columns:2; -moz-columns:2; }
    .footer{ font-size:.9rem; margin-top:1.5rem; text-align:center; color:#5b6b7a; }
  </style>
</head>
<body>
  <header class="hero">
    <nav class="container d-flex align-items-center justify-content-between py-3">
      <div class="d-flex align-items-center gap-2">
        <i class="fa-solid fa-tree text-success"></i>
        <strong>Evergreen Pact — Accountability</strong>
        <span class="badge text-bg-primary ms-2">District Flyer</span>
      </div>
      <div class="d-flex gap-2">
        <button class="btn btn-outline-secondary" onclick="window.print()">
          <i class="fa-solid fa-print me-1"></i> Print / PDF
        </button>
        <button id="exportDocx" class="btn btn-primary">
          <i class="fa-solid fa-file-word me-1"></i> Export to Word (.docx)
        </button>
      </div>
    </nav>
  </header>

  <main class="container my-4">
    <div id="flyer" class="flyer">
      <h1>Rep. <span id="targetName">Lastname</span>: <span class="nickname" id="nickname">GROCERY GOUGER</span></h1>
      <div class="tagline" id="tagline">Voted to keep your grocery bills high.</div>

      <div class="impact mb-3">
        <h2 class="h5">What they blocked:</h2>
        <ul id="impactList">
          <li>Ban on corporate grocery price-gouging.</li>
          <li>Stronger penalties for food cartels.</li>
          <li>Relief for families at checkout.</li>
        </ul>
      </div>

      <div class="voters mb-3">
        <h2 class="h5">NO Voters</h2>
        <ul id="noVoters">
          <li>Rep. Example A (TX)</li>
          <li>Rep. Example B (CA)</li>
        </ul>
      </div>

      <div class="voters mb-3">
        <h2 class="h5">YES Voters</h2>
        <ul id="yesVoters">
          <li>Rep. Example C (WA)</li>
          <li>Rep. Example D (OR)</li>
        </ul>
      </div>

      <div class="footer">
        Paid for by Adam Neil Arafat for Congress · <a href="https://arafatforcongress.org">arafatforcongress.org</a>
      </div>
    </div>
  </main>

  <!-- html-docx-js for Word export -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html-docx-js/0.4.1/html-docx.js"></script>
  <script>
    function exportDocx(){
      const flyer = document.getElementById('flyer').cloneNode(true);
      const html = `
      <!DOCTYPE html><html><head><meta charset="utf-8">
      <style>
        body{font-family:Calibri,Arial,sans-serif; color:#1b2634;}
        h1{color:#0d3b66; font-size:18pt; margin-bottom:6pt;}
        .nickname{color:#c1121f; font-size:22pt; font-weight:bold;}
        .tagline{font-size:12pt; margin:6pt 0 10pt;}
        ul{margin:0 0 10pt 18pt;}
        h2{color:#0d3b66; font-size:14pt; margin-top:12pt; margin-bottom:6pt;}
        .footer{font-size:9pt; color:#5b6b7a; margin-top:16pt; text-align:center;}
      </style>
      </head><body>${flyer.outerHTML}</body></html>`;
      const blob = window.htmlDocx.asBlob(html,{margins:{top:720,right:720,bottom:720,left:720}});
      const url = URL.createObjectURL(blob);
      const a=document.createElement('a');
      a.href=url; a.download='Evergreen_District_Flyer.docx';
      document.body.appendChild(a); a.click(); a.remove();
      setTimeout(()=>URL.revokeObjectURL(url),500);
    }
    document.getElementById('exportDocx').addEventListener('click',exportDocx);
  </script>
</body>
</html>
